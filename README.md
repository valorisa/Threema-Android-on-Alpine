---

# Threema-Android-on-Alpine

A step-by-step guide to building the [Threema Android](https://github.com/threema-ch/threema-android) app from source on Alpine Linux.

---

## Prerequisites

Before you begin, ensure you have the following installed on your Alpine Linux system:

- OpenJDK 17
- Gradle
- Git
- Bash
- Curl
- Unzip

Install them with:

```sh
sudo apk update
sudo apk add openjdk17 gradle git bash curl unzip
```

---

## 1. Clone the Repository

```sh
git clone https://github.com/threema-ch/threema-android.git
cd threema-android
```

---

## 2. Install the Android SDK Command Line Tools

Download and extract the Android SDK command line tools:

```sh
wget https://dl.google.com/android/repository/commandlinetools-linux-11076708_latest.zip
unzip commandlinetools-linux-11076708_latest.zip -d $HOME/android-sdk
```

Move the tools to the correct directory:

```sh
mkdir -p $HOME/android-sdk/cmdline-tools/latest
mv $HOME/android-sdk/cmdline-tools/* $HOME/android-sdk/cmdline-tools/latest/
```

Set environment variables (add these lines to your `~/.profile` or `~/.bashrc` for persistence):

```sh
export ANDROID_SDK_ROOT=$HOME/android-sdk
export PATH=$PATH:$ANDROID_SDK_ROOT/cmdline-tools/latest/bin
```

Reload your shell:

```sh
source ~/.profile
```

---

## 3. Install Required Android SDK Components

Install the necessary SDK packages (adjust the API level and build-tools version if needed):

```sh
sdkmanager --sdk_root=$ANDROID_SDK_ROOT "platform-tools" "platforms;android-34" "build-tools;34.0.0"
```

---

## 4. Build the Project

Make sure the Gradle wrapper is executable:

```sh
chmod +x gradlew
```

To build a release APK:

```sh
./gradlew assembleRelease
```

Or for a debug APK:

```sh
./gradlew assembleDebug
```

The resulting APK will be located in `app/build/outputs/apk/`.

---

## 5. Troubleshooting

- **Out of memory errors:**  
  Set Gradle JVM arguments:  
  `export ORG_GRADLE_JVMARGS="-Xmx2g"`
- **Dependency issues:**  
  Run `./gradlew dependencies` to check for missing dependencies.
- **Permission errors:**  
  Ensure all scripts are executable.

---

## 6. Signing the APK

To install the APK on a device, you must sign it. For testing, you can use the debug key generated by Gradle. For production, generate your own keystore.

---

## References

- [Threema Android GitHub](https://github.com/threema-ch/threema-android#building)
- [Android Command Line Tools](https://developer.android.com/studio#command-tools)

---

If you encounter any errors, please open an issue or consult the official Threema documentation.
